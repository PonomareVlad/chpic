{"version":3,"sources":["../src/FileSaver.js","domvas.js","main.js"],"names":["supportsCSSText","getComputedStyle","document","body","cssText","copyCSS","elem","origElem","log","computedStyle","style","prop","isNaN","parseInt","test","inlineStyles","children","querySelectorAll","origChildren","Array","prototype","forEach","call","child","i","margin","marginLeft","marginTop","marginBottom","marginRight","module","exports","toImage","callback","width","height","left","top","cloneNode","setAttribute","serialized","XMLSerializer","serializeToString","dataUri","offsetWidth","offsetHeight","img","Image","src","onload","require","saveAs","domvas","canvas","getElementById","context","getContext","container","navigator","canShare","classList","add","addEventListener","el","reader","FileReader","e","target","result","remove","drawImage","readAsDataURL","files","toBlob","blob","share","mimeType"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"../src","sourcesContent":["/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","// Source: https://github.com/pbakaus/domvas\n\nvar supportsCSSText = getComputedStyle(document.body).cssText !== \"\";\n\nfunction copyCSS(elem, origElem, log) {\n\n    var computedStyle = getComputedStyle(origElem);\n\n    if (supportsCSSText) {\n        elem.style.cssText = computedStyle.cssText;\n\n    } else {\n\n        // Really, Firefox?\n        for (var prop in computedStyle) {\n            if (isNaN(parseInt(prop, 10)) && typeof computedStyle[prop] !== 'function' && !(/^(cssText|length|parentRule)$/).test(prop)) {\n                elem.style[prop] = computedStyle[prop];\n            }\n        }\n\n    }\n\n}\n\nfunction inlineStyles(elem, origElem) {\n\n    var children = elem.querySelectorAll('*');\n    var origChildren = origElem.querySelectorAll('*');\n\n    // copy the current style to the clone\n    copyCSS(elem, origElem, 1);\n\n    // collect all nodes within the element, copy the current style to the clone\n    Array.prototype.forEach.call(children, function (child, i) {\n        copyCSS(child, origChildren[i]);\n    });\n\n    // strip margins from the outer element\n    elem.style.margin = elem.style.marginLeft = elem.style.marginTop = elem.style.marginBottom = elem.style.marginRight = '';\n\n}\n\nmodule.exports = {\n\n    toImage: function (origElem, callback, width, height, left, top) {\n\n        left = (left || 0);\n        top = (top || 0);\n\n        var elem = origElem.cloneNode(true);\n\n        // inline all CSS (ugh..)\n        inlineStyles(elem, origElem);\n\n        // unfortunately, SVG can only eat well formed XHTML\n        elem.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n\n        // serialize the DOM node to a String\n        var serialized = new XMLSerializer().serializeToString(elem);\n\n        // Create well formed data URL with our DOM string wrapped in SVG\n        var dataUri = \"data:image/svg+xml,\" +\n            \"<svg xmlns='http://www.w3.org/2000/svg' width='\" + ((width || origElem.offsetWidth) + left) + \"' height='\" + ((height || origElem.offsetHeight) + top) + \"'>\" +\n            \"<foreignObject width='100%' height='100%' x='\" + left + \"' y='\" + top + \"'>\" +\n            serialized +\n            \"</foreignObject>\" +\n            \"</svg>\";\n\n        // create new, actual image\n        var img = new Image();\n        img.src = dataUri;\n\n        // when loaded, fire onload callback with actual image node\n        img.onload = function () {\n            if (callback) {\n                callback.call(this, this);\n            }\n        };\n\n    }\n\n};\n","// var domtoimage = require('dom-to-image');\nvar { saveAs } = require('file-saver');\nvar domvas = require('./domvas');\nvar canvas = document.getElementById('canvas');\nvar context = canvas.getContext('2d');\n\nvar container = document.getElementById('container');\n\nif (navigator.canShare && navigator.canShare()) {\n    container.classList.add('share');\n}\n\ndocument.getElementById('filepicker').addEventListener('change', (el) => {\n    var reader = new FileReader();\n    reader.onload = function (e) {\n        document.getElementById('preview').setAttribute('src', e.target.result);\n\n        container.classList.remove('step-1');\n        container.classList.add('step-2');\n\n        domvas.toImage(document.getElementById('preview'), function () {\n            context.drawImage(this, 0, 0);\n            // document.getElementById('download').href = canvas.toDataURL('image/png');\n        });\n\n\n        // domtoimage.toSvg(document.getElementById('preview'))\n        //     .then(function (result) {\n        //         console.log(result);\n\n        //         document.getElementById('download').href = result;\n        //     });\n        // var svg = document.querySelector('svg');\n        // var data = new XMLSerializer().serializeToString(svg);\n        // var win = window.URL || window.webkitURL || window;\n        // var img = new Image();\n        // var blob = new Blob([data], { type: 'image/svg+xml' });\n        // var url = win.createObjectURL(blob);\n        // img.onload = function () {\n        //     context.drawImage(img, 0, 0);\n        //     win.revokeObjectURL(url);\n        //     // var uri = canvas.toDataURL('image/png').replace('image/png', 'octet/stream');\n        //     // var a = document.createElement('a');\n        //     // document.body.appendChild(a);\n        //     // a.style = 'display: none';\n        //     // a.href = uri\n        //     // a.download = (svg.id || svg.svg.getAttribute('name') || svg.getAttribute('aria-label') || 'untitled') + '.png';\n        //     // a.click();\n        //     // window.URL.revokeObjectURL(uri);\n        //     // document.body.removeChild(a);\n        // };\n        // img.src = url;\n    };\n\n    reader.readAsDataURL(el.target.files[0])\n});\n\ndocument.getElementById('download').addEventListener('click', () => {\n    canvas.toBlob(function(blob) {\n        saveAs(blob, \"ch-avatar.png\");\n    });\n    // domtoimage.toSvg(document.getElementById('preview'))\n    //     .then(function (result) {\n    //         console.log(result);\n    //         // window.saveAs(result, 'my-ch-avatar.png');\n    //     })\n    //     .catch((err) => console.error(err));\n});\n\n\ndocument.getElementById('download').addEventListener('click', () => {\n    canvas.toBlob(function(blob) {\n        navigator.share({ blob, mimeType: 'image/png'});\n    });\n})"]}